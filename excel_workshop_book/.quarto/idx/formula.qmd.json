{"title":"Formulas and Functions","markdown":{"headingText":"Formulas and Functions","containsRefs":false,"markdown":"\nAs said earlier, formulas are what makes spreadsheet a spreadsheet. You use formulas in your Excel worksheets to calculate results from the data stored in the worksheet. When data changes, the formulas calculate updated results with no extra effort on your part.\n\n## Formula Basics\n\nFormulas in Excel are expressions that perform calculations or operations on values in a worksheet. They can range from simple arithmetic calculations to sophisticated logical operations and statistical analyses. Excel formulas start with an equal sign (=) followed by any of these elements:\n\n-   Mathematical operators such as + (for addition), \\* (for multiplication)\n-   Cell references (including named cells and ranges)\n-   Values or text\n-   Worksheet functions (such as `SUM` and `AVERAGE`)\n\nAfter you enter the formula, excel displays the calculated result in the cell(s).\n\nFew examples of formulas:\n\n| Example                 | Formula                      |\n|-------------------------|------------------------------|\n| Simple Addition         | `=A1 + B1`                   |\n| Multiplication          | `=A1 * B1`                   |\n| SUM Function            | `=SUM(A1:A10)`               |\n| AVERAGE Function        | `=AVERAGE(A1:A10)`           |\n| IF Function             | `=IF(A1>10, \"Pass\", \"Fail\")` |\n| Conditional Calculation | `=IF(A1>100, A1*10, A1*5)`   |\n\n## Operators used in formulas\n\nOperators are symbols that indicate what mathematical (or logical) operation you want the formula to perform.\n\n| Operator | Name                                          |\n|----------|-----------------------------------------------|\n| \\+       | Addition                                      |\n| \\-       | Subtraction                                   |\n| \\*       | Multiplication                                |\n| /        | Division                                      |\n| \\^       | Exponentiation                                |\n| &        | Concatenation                                 |\n| =        | Logical comparison (equal to)                 |\n| \\>       | Logical comparison (greater than)             |\n| \\<       | Logical comparison (less than)                |\n| \\>=      | Logical comparison (greater than or equal to) |\n| \\<=      | Logical comparison (less than or equal to)    |\n| \\<\\>     | Logical comparison (not equal to)             |\n\n## Function Basics\n\nA function is a predefined formula that performs calculations or task using specific values in a particular order. These functions are designed to simplify complex calculations and streamline repetitive tasks, saving you time and effort.\n\n### Syntax\n\nEvery Excel function follows a standardized syntax, consisting of the function name, followed by parentheses enclosing one or more arguments. Arguments are the inputs provided to the function, which determine its behavior and output. Understanding the syntax of a function is crucial for using it correctly. Let's break it down:\n\n``` default\n=FUNCTION_NAME(argument1, argument2, ...)\n```\n\n-   **Function Name**: This is the name of the function that defines its purpose. Examples include SUM, AVERAGE, IF, VLOOKUP, etc.\n\n-   **Arguments**: These are the values or cell references provided to the function to perform the desired calculation. The number and type of arguments vary depending on the function.\n\n## Referencing Cells in Other Worksheets\n\nTo use a reference to a cell in another worksheet in the same workbook, use this format:\n\n``` default\n=SheetName!CellAddress\n```\n\nIn other words, precede the cell address with the worksheet name followed by an exclamation point. Here's an example of a formula that uses a cell on the Sheet2 worksheet:\n\n``` default\n=A1*Sheet2!A1\n```\n\nThis formula multiplies the value in cell A1 on the current worksheet by the value in cell A1 on Sheet2.\n\n## Referencing Data in a Table\n\nWe have discussed about Excel Tables in @sec-tables.\n\nTables in Excel come with predefined headers for each column. These headers provide an intuitive way to reference data within the table. You can use these headers in formulas and functions to retrieve specific information.\n\nFor instance, you have a table named \"PatientData\" with columns: \"Name\", \"Age\", \"Sex\", \"Days of Hospitalization\". To find the average days of hospitalization, you can use the formula:\n\n``` default\n=AVERAGE(PatientData[Days of Hospitalization])\n```\n\nHere `PatientData[Days of Hospitalization]` refers to \"Days of Hospitalization\" column in the table \"PatientData\".\n\n## Common Formula Errors\n\nSometimes when you enter a formula, Excel displays a value that begins with a hash mark (#). This is a signal that the formula is returning an error value. You have to correct the formula (or correct a cell that the formula references) to get rid of the error display.\n\n| Error Value | Explanation                                                                                                                                                                                                                                                                                                                               |\n|-----------------|-------------------------------------------------------|\n| #DIV/0!     | The formula is trying to divide by zero. Because Excel applies a value of 0 to empty cells, this error also occurs when the formula attempts to divide by a cell that is blank or has a value of 0.                                                                                                                                       |\n| #NAME?      | The formula uses a name that Excel doesn't recognize. This can happen if you delete a name that's used in the formula, if you misspell a name and then hit Enter, or if you have unmatched quotes when using text.                                                                                                                        |\n| #N/A        | The formula is referring (directly or indirectly) to a cell that uses the NA function to signal that data is not available. For instance, the following formula returns an #N/A error if the A1 is empty: =IF(A1=\"\", NA(), A1) Some lookup functions (for example, VLOOKUP and MATCH) can also return #N/A when they do not find a match. |\n| #NULL!      | The formula uses an intersection of two ranges that don't intersect. (This concept is described later in the chapter.)                                                                                                                                                                                                                    |\n| #NUM!       | A problem with a value exists; for example, you specified a negative number as an argument where a positive number is required.                                                                                                                                                                                                           |\n| #REF!       | The formula refers to a cell that isn't valid. This can happen if the cell has been deleted from the worksheet.                                                                                                                                                                                                                           |\n| #VALUE!     | The formula includes an argument or operand of the wrong type. (An operand is a value or cell reference that a formula uses to calculate a result.                                                                                                                                                                                        |\n\n## Formula for Common Mathematical Operations\n\nLike everyone who has to use Excel, public health students and professionals also will be asked to perform mathematical operations that provide insight into the data. We will see some examples of formulas that will help with this type of analyses.\n\n## Calculating Percentages\n\nUnderstanding the proportion of individual values in relation to the total is crucial for insightful analysis. Excel simplifies this task with the following formula:\n\n``` default\n= (Value / Total) * 100\n```\n\nHere, \"Value\" represents the specific data point you're interested in, and \"Total\" denotes the sum of all relevant values. By multiplying the quotient with 100, you obtain the percentage representation.\n\nFor example, suppose you have a dataset containing the number of cases of a disease for different states in a country and you want to calculate the percentage of the cases in each state out of the total cases in the country. You can use the formula `=(Cases in State / Total Cases in Country) * 100` to find the percentage for each region.\n\nDragging this formula across the dataset will swiftly compute the percentage of cases in each state. <br>\n\nAnalyzing variations between two data points is essential for detecting trends or anomalies. The formula for calculating percentage variance is:\n\n``` default\n= ((New Value - Old Value) / Old Value) * 100\n```\n\nIn this formula, \"New Value\" signifies the updated or later data point, while \"Old Value\" represents the initial or previous data point. The difference between the new and old values, divided by the old value and multiplied by 100, yields the percentage variance.\n\nConsider a scenario where you have data on the number of cases of a disease for two consecutive years. To calculate the percentage increase in cases from one year to the next, you can use the formula `=((Cases in Year 2 - Cases in Year 1) / Cases in Year 1) * 100`.\n\nExecuting this formula provides a clear percentage representation of the case variation, indicating whether cases have increased or decreased and by what percentage.\n\nExercise file is available [here](exercise/percentage.xlsx)\n\n## Counting Values in a Range\n\nExcel provides several functions to count the values in a range. They allow ypu to quickly tally up occurrences, quantify datasets, and derive valuable insights.\n\n### COUNT() Function\n\nThe `COUNT()` function is a fundamental tool for counting numeric values within a dataset. It disregards empty cells and cells containing text or errors.\n\n**Syntax:** `=COUNT(value1, [value2], ...)`\n\n**Example:**\n\nConsider a dataset containing the number of confirmed COVID-19 cases per day in a specific area:\n\n| Day   | Confirmed Cases |\n|-------|-----------------|\n| Day 1 | 350             |\n| Day 2 | 520             |\n| Day 3 |                 |\n| Day 4 | 430             |\n| Day 5 | Error           |\n| Day 6 | 650             |\n\nTo count the the total number of days with reported cases:\n\n``` default\n=COUNT(A2:A7)\n```\n\nThis formula will return `4`, as there are four numeric values in the specified range.\n\n### COUNTA() Function\n\nWhile `COUNT()` tallies only numeric values, `COUNTA()` extends its capability to count all non-blank cells, including text and errors.\n\n**Syntax:** `=COUNTA(value1, [value2], ...)`\n\n**Example:**\n\nUsing the same dataset, let's count all non-blank cells:\n\n``` default\n=COUNTA(A2:A7)\n```\n\nThis formula will return `5`, including both numeric values and the error.\n\n### COUNTIF() Function\n\nThe `COUNTIF()` function is invaluable for counting cells that meet specific criteria within a dataset.\n\n**Syntax:** `=COUNTIF(range, criteria)`\n\n**Example:**\n\nSuppose we want to count the number of days confirmed cases exceeding 400:\n\n``` default\n=COUNTIF(A2:A7, \">400\")\n```\n\nThis formula will return `3`, indicating there are three days in which number of daily confirmed cases were greater than 400.\n\n### COUNTIFS() Function\n\nSimilar to `COUNTIF()`, `COUNTIFS()` extends its functionality to count cells based on multiple criteria.\n\n**Syntax:** `=COUNTIFS(criteria_range1, criteria1, [criteria_range2, criteria2], ...)`\n\n**Example:**\n\nConsider a scenario where we want to count the days with more than 100 cases in a specific region. We can use COUNTIFS() to achieve this by specifying both the region and the case count threshold.\n\n``` default\n=COUNTIFS(A2:A7, \">400\", B2:B7, \"Region A\")\n```\n\n\n\n\n\n> Excel enables you to enter flexible formulas that use the values (or even text) in cells to calculate a result. When you enter a formula into a cell, the formula's result appears in the cell. If you change any of the cells used by a formula, the formula recalculates and shows the new result.[@allen2017]\n\n> abs, round\n","srcMarkdownNoYaml":""},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"formula.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.551","bibliography":["references.bib"],"editor":"visual","theme":"cosmo"},"extensions":{"book":{"multiFile":true}}},"pdf":{"identifier":{"display-name":"PDF","target-format":"pdf","base-format":"pdf"},"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","output-file":"formula.pdf"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"block-headings":true,"bibliography":["references.bib"],"editor":"visual","documentclass":"scrreprt"},"extensions":{"book":{"selfContainedOutput":true}}}},"projectFormats":["html","pdf"]}