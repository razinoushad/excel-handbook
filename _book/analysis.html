<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Excel for Public Health Students - 4&nbsp; Data Cleaning and Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./power_query.html" rel="next">
<link href="./visualizations.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./analysis.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Cleaning and Analysis</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Excel for Public Health Students</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Getting Started</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./formula.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Formulas and Functions</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./visualizations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Creating Visuals</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./analysis.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Cleaning and Analysis</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./power_query.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Power Query</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#cleaning-data" id="toc-cleaning-data" class="nav-link active" data-scroll-target="#cleaning-data"><span class="header-section-number">4.1</span> Cleaning Data</a>
  <ul class="collapse">
  <li><a href="#remove-duplicate-rows" id="toc-remove-duplicate-rows" class="nav-link" data-scroll-target="#remove-duplicate-rows"><span class="header-section-number">4.1.1</span> Remove Duplicate Rows</a></li>
  <li><a href="#splitting-text" id="toc-splitting-text" class="nav-link" data-scroll-target="#splitting-text"><span class="header-section-number">4.1.2</span> Splitting Text</a></li>
  <li><a href="#removing-extra-space" id="toc-removing-extra-space" class="nav-link" data-scroll-target="#removing-extra-space"><span class="header-section-number">4.1.3</span> Removing Extra Space</a></li>
  <li><a href="#changing-the-case-of-text" id="toc-changing-the-case-of-text" class="nav-link" data-scroll-target="#changing-the-case-of-text"><span class="header-section-number">4.1.4</span> Changing the case of Text</a></li>
  <li><a href="#converting-values" id="toc-converting-values" class="nav-link" data-scroll-target="#converting-values"><span class="header-section-number">4.1.5</span> Converting Values</a></li>
  <li><a href="#classifying-values" id="toc-classifying-values" class="nav-link" data-scroll-target="#classifying-values"><span class="header-section-number">4.1.6</span> Classifying Values</a></li>
  <li><a href="#joining-columns" id="toc-joining-columns" class="nav-link" data-scroll-target="#joining-columns"><span class="header-section-number">4.1.7</span> Joining Columns</a></li>
  </ul></li>
  <li><a href="#data-validation" id="toc-data-validation" class="nav-link" data-scroll-target="#data-validation"><span class="header-section-number">4.2</span> Data Validation</a>
  <ul class="collapse">
  <li><a href="#specifying-validation-criteria" id="toc-specifying-validation-criteria" class="nav-link" data-scroll-target="#specifying-validation-criteria"><span class="header-section-number">4.2.1</span> Specifying Validation Criteria</a></li>
  <li><a href="#types-of-validation-criteria" id="toc-types-of-validation-criteria" class="nav-link" data-scroll-target="#types-of-validation-criteria"><span class="header-section-number">4.2.2</span> Types of Validation Criteria</a></li>
  <li><a href="#creating-a-dropdown-list" id="toc-creating-a-dropdown-list" class="nav-link" data-scroll-target="#creating-a-dropdown-list"><span class="header-section-number">4.2.3</span> Creating a Dropdown List</a></li>
  </ul></li>
  <li><a href="#creating-a-dependent-list" id="toc-creating-a-dependent-list" class="nav-link" data-scroll-target="#creating-a-dependent-list"><span class="header-section-number">4.3</span> Creating a Dependent List</a></li>
  <li><a href="#pivot-tables" id="toc-pivot-tables" class="nav-link" data-scroll-target="#pivot-tables"><span class="header-section-number">4.4</span> Pivot Tables</a>
  <ul class="collapse">
  <li><a href="#creating-pivot-table" id="toc-creating-pivot-table" class="nav-link" data-scroll-target="#creating-pivot-table"><span class="header-section-number">4.4.1</span> Creating Pivot Table</a></li>
  <li><a href="#commands-in-the-pivottable-analyze-tab" id="toc-commands-in-the-pivottable-analyze-tab" class="nav-link" data-scroll-target="#commands-in-the-pivottable-analyze-tab"><span class="header-section-number">4.4.2</span> Commands in the PivotTable Analyze Tab</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Data Cleaning and Analysis</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>Data analysis is the process of inspecting, cleaning, transforming, and modeling data to discover useful information, inform conclusions, and support decision-making. Excel is also a tool for data analysis that enables you to manipulate, analyze, and visualize data quickly and easily. Excel can do most of the data analysis jobs you encounter in your day to day activities. For advanced analysis other software can be used.</p>
<section id="cleaning-data" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="cleaning-data"><span class="header-section-number">4.1</span> Cleaning Data</h2>
<p>Data cleaning involves fixing or removing incorrect, corrupted, incorrectly formatted, duplicate, or incomplete data within a dataset. When combining various data sources, there are numerous chances for data duplication or misidentification. Inaccurate data can lead to unreliable results and outcomes. Since data cleaning processes differ from one dataset to another, there isn’t a singular approach to outlining precise steps. Nonetheless, it’s crucial to establish a template for your data cleaning process to ensure consistent and correct analysis everytime. In this section, we will see some data cleaning techniques which you must be familiar with.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Before cleaning your dataset, consider making a copy of your original dataset. This way, you can always revert to the original data if needed.</p>
</div>
</div>
<section id="remove-duplicate-rows" class="level3" data-number="4.1.1">
<h3 data-number="4.1.1" class="anchored" data-anchor-id="remove-duplicate-rows"><span class="header-section-number">4.1.1</span> Remove Duplicate Rows</h3>
<p>Duplicate rows can clutter your data and make analysis challenging. Excel provides powerful tools to identify and remove these duplicate entries efficiently.</p>
<ol type="1">
<li><p><strong>Select Your Data</strong>: Begin by selecting the range of cells or the entire table from which you want to remove duplicates.</p></li>
<li><p><strong>Navigate to the Data Tab</strong>: Click on the “Data” tab in the Excel ribbon at the top of the screen.</p></li>
<li><p><strong>Click on Remove Duplicates</strong>: In the Data Tools group, locate and click on “Remove Duplicates.”</p></li>
</ol>
<p><img src="images/duplicate-remove.png" class="img-fluid"></p>
<ol start="4" type="1">
<li><p><strong>Choose Columns</strong>: A dialog box will appear listing all the columns in your selected range. You can choose the columns where you want Excel to check for duplicates. By default, all columns are selected.</p></li>
<li><p><strong>Determine Criteria</strong>: Decide whether you want Excel to consider all columns collectively or only specific columns when identifying duplicates. Check or uncheck the boxes accordingly. For example, if your data have some unique identifier (like ID Card No) then you can select that column only.</p></li>
<li><p><strong>Remove Duplicates</strong>: After setting your criteria, click “OK.” Excel will process the data and remove any duplicate rows based on your specified criteria.</p></li>
</ol>
<p><img src="images/dulpicate-dialog.png" class="img-fluid" width="436"></p>
<ol start="7" type="1">
<li><strong>Review Results</strong>: Excel will display a message indicating how many duplicate values were found and removed. Click “OK” to close the message box.</li>
</ol>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>To visually identify duplicates before removing them, apply conditional formatting to highlight duplicate values within your dataset.</p>
</div>
</div>
</section>
<section id="splitting-text" class="level3" data-number="4.1.2">
<h3 data-number="4.1.2" class="anchored" data-anchor-id="splitting-text"><span class="header-section-number">4.1.2</span> Splitting Text</h3>
<p>One of the powerful features of Excel is its ability to manipulate and organize data efficiently. The “Split to Columns” function is useful when you need to separate text within cells into multiple columns based on a delimiter or a specific character. This feature can save you time and effort, especially when dealing with large datasets.</p>
<ol type="1">
<li><p><strong>Select Your Data Range:</strong><br>
First, make sure the column that contains the data to be split up has enough empty columns to the right to accommodate the extracted data. Select the cells that contain the text you want to split into columns. Ensure that each cell contains the text you wish to separate.</p></li>
<li><p><strong>Navigate to the Data Tab:</strong><br>
Go to the Excel ribbon and click on the “Data” tab.</p></li>
<li><p><strong>Choose “Text to Columns”:</strong><br>
Within the “Data Tools” group, locate and click on “Text to Columns.” This action will launch the “Convert Text to Columns Wizard.”</p></li>
</ol>
<p><img src="images/split-text.png" class="img-fluid"></p>
<ol start="4" type="1">
<li><p><strong>Select the Delimiter:</strong><br>
In the first step of the wizard, you’ll be prompted to choose how you want to split your data. Excel gives you the option to split by delimiter (such as commas, spaces, tabs, or custom characters used to separates text items) or by fixed width. Choose the appropriate option based on your data format and click “Next.”</p></li>
<li><p><strong>Specify Delimiter Settings (if applicable):</strong><br>
If you selected to split by delimiter, specify which delimiter Excel should use for splitting your text. You can choose from predefined delimiters like Tab, Semicolon, Comma, Space, or specify a custom delimiter. Preview the results in the Data preview window to ensure the split is as expected.</p></li>
<li><p><strong>Configure Column Data Format (if needed):</strong><br>
In the next step, you can format each column of data. Choose the data format (General, Text, Date, etc.) for each column or keep it as is. Click “Finish” once you are satisfied with your selections.</p></li>
<li><p><strong>Review Your Split Data:</strong><br>
Excel will automatically split the selected text into separate columns based on your specifications. Review the resulting columns to ensure the split was successful and meets your requirements.</p></li>
</ol>
<p><img src="images/split-wizard.png" class="img-fluid" width="430"></p>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>Always use the Data preview window to see how your text will be split before finalizing the operation.</p>
</div>
</div>
</section>
<section id="removing-extra-space" class="level3" data-number="4.1.3">
<h3 data-number="4.1.3" class="anchored" data-anchor-id="removing-extra-space"><span class="header-section-number">4.1.3</span> Removing Extra Space</h3>
<p>Sometimes, the data contains extra spaces. It is very difficult to spot a space character at the end of a text string. It can cause problems when you are doing analysis. For example, ‘Male’ is not same as ‘Male’. When you do analysis, there will be two variable values ‘Male’ and ‘Male’, but basically both are the same.</p>
<p>To solve this, use the TRIM() function, which removes leading and trailing spaces while condensing multiple interior spaces into a single space.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>=TRIM(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p><code>text</code>: This is the text string from which you want to remove extra spaces.</p>
</section>
<section id="changing-the-case-of-text" class="level3" data-number="4.1.4">
<h3 data-number="4.1.4" class="anchored" data-anchor-id="changing-the-case-of-text"><span class="header-section-number">4.1.4</span> Changing the case of Text</h3>
<p>Mostly, you need to make text in columns consistent in terms of case. Unlike Microsoft Word, Excel doesn’t provide a direct way to do it. But we can change the case using functions. The relevant functions are as follows:</p>
<ol type="1">
<li>The <code>UPPER()</code> function converts all letters in a text string to uppercase.</li>
</ol>
<div class="sourceCode" id="cb2"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>=UPPER(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="2" type="1">
<li>The <code>LOWER()</code> function converts all letters in a text string to lowercase.</li>
</ol>
<div class="sourceCode" id="cb3"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>=LOWER(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ol start="3" type="1">
<li>The <code>PROPER()</code> function capitalizes the first letter of each word in a text string and converts all other letters to lowercase.</li>
</ol>
<div class="sourceCode" id="cb4"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>=PROPER(text)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="converting-values" class="level3" data-number="4.1.5">
<h3 data-number="4.1.5" class="anchored" data-anchor-id="converting-values"><span class="header-section-number">4.1.5</span> Converting Values</h3>
<p>The <code>CONVERT()</code> function allows you to convert a measurement from one unit to another within the same measurement category.</p>
<p>The <code>CONVERT()</code> function in Excel follows a specific syntax:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>=CONVERT(number, from_unit, to_unit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>number</strong>: This is the value you want to convert.</li>
<li><strong>from_unit</strong>: The current unit of the value you want to convert.</li>
<li><strong>to_unit</strong>: The unit to which you want to convert the value.</li>
</ul>
<p>Imagine you have a dataset containing temperature recorded in Fahrenheit (F) in cell A1, and you need to convert these weights to Celsius (C) for analysis or reporting purposes. Let’s use the <code>CONVERT()</code> function to do this conversion.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>=CONVERT(A1,"F","C")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In this example:</p>
<ul>
<li>A1: contain the temperature reading in Fahrenheit</li>
<li>“F”: represent the temperature in Fahrenheit</li>
<li>“C”: indicates the desired unit for conversion(Celsius)</li>
</ul>
</section>
<section id="classifying-values" class="level3" data-number="4.1.6">
<h3 data-number="4.1.6" class="anchored" data-anchor-id="classifying-values"><span class="header-section-number">4.1.6</span> Classifying Values</h3>
<p>Often, you may have values that need to be classified into a group. In Excel, you can classify values into groups using the <code>IFS()</code> function along with logical tests. The <code>IFS()</code> function allows you for multiple conditions to be evaluated, and based on whether the condition is true or false, return different values. This can be used effectively to create categories or groups for your data.</p>
<p>Suppose you have data on the ages of participants of a survey in column A, and you want to classify these values into three groups:</p>
<ul>
<li>Child: Values less than 18</li>
<li>Adult: Values between 18 and 60 (inclusive)</li>
<li>Elder: Values greater than 60</li>
</ul>
<p>In an adjacent column (e.g., column B), enter the following formula in the first cell (e.g., B2) to classify the value in A2:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>=IFS(A2&lt;18,"Child", A2&lt;=60,"Adult", A2&gt;60,"Elder")</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>You can extend the formula down the column by dragging the cell handle. This will automatically apply the formula to all the cells in the column.</p>
<p><img src="images/classify-values.png" class="img-fluid" width="423"></p>
</section>
<section id="joining-columns" class="level3" data-number="4.1.7">
<h3 data-number="4.1.7" class="anchored" data-anchor-id="joining-columns"><span class="header-section-number">4.1.7</span> Joining Columns</h3>
<p>Combining text from different columns into a single cell can be efficiently achieved using the <code>CONCAT()</code> or <code>TEXTJOIN()</code> functions.</p>
<section id="using-concat-function" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="using-concat-function">Using CONCAT() Function</h4>
<p>The <code>CONCAT()</code> function in Excel is used to concatenate, or join, text from different cells or ranges into one cell. It is particularly useful when you want to combine text strings without using any delimiter (a character that separates text items). You can include additional separators or formatting within the CONCAT() function to control how the text is combined (e.g., adding spaces, commas, etc.).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>=CONCAT(text1, [text2], ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>text1</strong>: This is the first text or cell reference that you want to concatenate.</li>
<li><strong>[text2]</strong>: Additional text or cell references that you want to join.</li>
</ul>
<p>See the example in figure below:</p>
<p><img src="images/concat.png" class="img-fluid" width="400"></p>
</section>
<section id="using-textjoin-function" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="using-textjoin-function">Using TEXTJOIN() Function</h4>
<p>The TEXTJOIN() function allows you to concatenate text from a range of cells with specified delimiters (such as commas, spaces, or custom characters) between each item. This function is highly flexible and can handle situations where you need to skip empty cells or include only non-empty values.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode default code-with-copy"><code class="sourceCode default"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>=TEXTJOIN(delimiter, ignore_empty, text1, [text2], ...)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li><strong>delimiter</strong>: The delimiter to be used between each text item.</li>
<li><strong>ignore_empty</strong>: A logical value (TRUE or FALSE) that specifies whether to ignore empty cells.</li>
<li><strong>text1, text2, …</strong>: The text values or cell ranges that you want to concatenate.</li>
</ul>
<p>See the example in figure below:</p>
<p><img src="images/text-join.png" class="img-fluid" width="400"></p>
</section>
</section>
</section>
<section id="data-validation" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="data-validation"><span class="header-section-number">4.2</span> Data Validation</h2>
<p>Data validation is a powerful feature that allows you to control what type of data can be entered into a cell. For example, you may want to limt the data entry in a particular range to whole numbers between 1 and 100. If you make an invalid entry, you can display a custom message. By setting validation criteria, you can ensure data integrity, accuracy, and consistency throughout your spreadsheets. Let’s see how to use data validation effectively.</p>
<section id="specifying-validation-criteria" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="specifying-validation-criteria"><span class="header-section-number">4.2.1</span> Specifying Validation Criteria</h3>
<ol type="1">
<li><strong>Selecting Cells for Validation:</strong>
<ul>
<li>Begin by selecting the cells where you want to apply data validation. You can select a single cell, a range of cells, or even an entire column.</li>
</ul></li>
<li><strong>Accessing Data Validation:</strong>
<ul>
<li>Navigate to the <strong>Data</strong> tab on the ribbon.</li>
<li>Click on <strong>Data Validation</strong> in the <strong>Data Tools</strong> group.</li>
</ul></li>
<li><strong>Setting Validation Rules:</strong>
<ul>
<li>In the Data Validation dialog box, choose the type of validation you want under the <strong>Settings</strong> tab.</li>
<li>For example, to allow only whole numbers between 1 and 100, select <strong>Whole number</strong> and specify the minimum and maximum values.</li>
</ul>
<img src="images/validation-set.png" class="img-fluid" width="750"></li>
</ol>
</section>
<section id="types-of-validation-criteria" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="types-of-validation-criteria"><span class="header-section-number">4.2.2</span> Types of Validation Criteria</h3>
<p>Excel offers several validation criteria options, including:</p>
<ul>
<li><strong>Whole Number:</strong> Restricts input to whole numbers within a specified range.</li>
<li><strong>Decimal:</strong> Allows decimal numbers within a specified range.</li>
<li><strong>List:</strong> Limits input to items in a predefined list.</li>
<li><strong>Date:</strong> Validates input as dates within a specified period.</li>
<li><strong>Time:</strong> Validates input as times.</li>
<li><strong>Text Length:</strong> Controls the length of text allowed in a cell.</li>
<li><strong>Custom:</strong> Uses a custom formula to determine if input is valid.</li>
</ul>
</section>
<section id="creating-a-dropdown-list" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="creating-a-dropdown-list"><span class="header-section-number">4.2.3</span> Creating a Dropdown List</h3>
<p>Dropdown lists are particularly useful for ensuring data consistency and ease of use. Here’s how to set up a dropdown list using data validation:</p>
<ol type="1">
<li><p><strong>Specify List Items:</strong></p>
<ul>
<li>Enter the items you want in the dropdown list in a separate column or range.</li>
</ul></li>
<li><p><strong>Select Cells for Dropdown:</strong></p>
<ul>
<li>Choose the cells where you want the dropdown list to appear.</li>
</ul></li>
<li><p><strong>Set Data Validation:</strong></p>
<ul>
<li>Access the Data Validation dialog box.</li>
<li>Choose <strong>List</strong> under <strong>Allow</strong>.</li>
<li>Specify the source of the list using the range selector or by typing the range directly (e.g., <code>=$E$3:$E$6</code>).</li>
<li>You can also write the list items in <strong>Source</strong> box, each items seperated by comma.</li>
</ul>
<p><img src="images/validation-list.png" class="img-fluid" width="580"></p></li>
<li><p><strong>Enable the Dropdown:</strong></p>
<ul>
<li>Now, the selected cells will display a dropdown arrow, allowing users to choose from the predefined list.</li>
</ul></li>
</ol>
</section>
</section>
<section id="creating-a-dependent-list" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="creating-a-dependent-list"><span class="header-section-number">4.3</span> Creating a Dependent List</h2>
<blockquote class="blockquote">
<p>this part is yet to be written</p>
</blockquote>
</section>
<section id="pivot-tables" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="pivot-tables"><span class="header-section-number">4.4</span> Pivot Tables</h2>
<p>The PivotTable feature is perhaps the most technologically sophisticated component in Excel. A pivot table can provide quick answers to questions about your table that can otherwise only be answered by complicated formulas.</p>
<section id="creating-pivot-table" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="creating-pivot-table"><span class="header-section-number">4.4.1</span> Creating Pivot Table</h3>
<ol type="1">
<li><p><strong>Prepare Your Data</strong> Ensure your dataset is organized with column headers and rows of data. Each column should have a clear heading, and there should be no blank rows or columns within the dataset.</p></li>
<li><p><strong>Select Your Data</strong> Click anywhere inside your dataset. Alternatively, you can manually select the range of cells that contain your data.</p></li>
<li><p><strong>Insert PivotTable</strong> Navigate to the “Insert” tab on the ribbon at the top of Excel. Click on “PivotTable” in the “Tables” group. This will open the Create PivotTable dialog box.</p></li>
<li><p><strong>Select Your Data Range</strong> Ensure the correct range of data is selected in the “Table/Range” field of the Create PivotTable dialog box. Excel should automatically detect the range based on your selection in Step 2.</p></li>
<li><p><strong>Choose Where to Place the PivotTable</strong> Select where you want your PivotTable to be placed. You can either choose to place it in a new worksheet or in an existing worksheet.</p></li>
<li><p><strong>Click “OK”</strong> Once you’ve selected your data range and the destination for your PivotTable, click “OK”. This will create a new PivotTable or insert one into the designated location.</p>
<p><img src="images/pivot-table-insert.png" class="img-fluid"></p></li>
<li><p><strong>Design Your PivotTable</strong></p>
<ul>
<li><strong>Fields List:</strong> A new pane will appear on the right, called “PivotTable Fields”. This pane lists all the column headers from your dataset.</li>
<li><strong>Drag Fields to Areas:</strong> Drag the fields you want to analyze into the different areas of the PivotTable:
<ul>
<li><strong>Values:</strong> Drag the fields you want to perform calculations on (e.g., sums, averages) into this area.</li>
<li><strong>Rows:</strong> Drag fields here to use them as row labels in your PivotTable.</li>
<li><strong>Columns:</strong> Drag fields here to use them as column labels in your PivotTable.</li>
<li><strong>Filters:</strong> Drag fields here to use them as filters for your PivotTable.</li>
</ul></li>
</ul>
<p><img src="images/pivot-table-result.png" class="img-fluid"></p></li>
<li><p><strong>Customize Your PivotTable</strong></p>
<ul>
<li><strong>Apply Filters:</strong> Use the dropdown arrows next to field names in the PivotTable to filter data.</li>
<li><strong>Change Summarization:</strong> Right-Click on any value in the PivotTable, choose “Value Field Settings” to change the calculation type (e.g., sum, count, average).</li>
<li><strong>Format Your PivotTable:</strong> Modify the PivotTable’s design, style, and layout using options in the “PivotTable Analyze” tab that appears when the PivotTable is selected.</li>
</ul></li>
<li><p><strong>Refresh Your PivotTable (if needed)</strong> If your data changes, you can refresh your PivotTable to reflect the updated information. Simply right-click on the PivotTable and choose “Refresh”.</p></li>
</ol>
</section>
<section id="commands-in-the-pivottable-analyze-tab" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="commands-in-the-pivottable-analyze-tab"><span class="header-section-number">4.4.2</span> Commands in the PivotTable Analyze Tab</h3>
<section id="data" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="data"><strong>Data</strong></h4>
<ul>
<li><strong>Refresh</strong>: This command updates the pivot table with the latest data from the source range. It’s useful when your underlying dataset has changed, and you want your pivot table to reflect those changes.</li>
<li><strong>Change Data Source</strong>: Use this command to modify the source data range for your pivot table. If you’ve added more data to your dataset or want to change the range for any reason, this option is essential.</li>
</ul>
</section>
<section id="actions" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="actions"><strong>Actions</strong></h4>
<ul>
<li><strong>Select</strong>: Allows you to select specific elements within your pivot table, such as cells, columns, or rows, for further manipulation.</li>
<li><strong>Move PivotTable</strong>: You can relocate your pivot table within the same workbook or to a different worksheet using this option.</li>
<li><strong>Clear</strong>: Removes applied filters or customizations, or formatting from the pivot table.</li>
</ul>
</section>
<section id="fields-items-sets" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="fields-items-sets"><strong>Fields, Items &amp; Sets</strong></h4>
<ul>
<li><strong>PivotTable Fields</strong>: Opens or closes the PivotTable Fields pane, which lets you add, remove, or rearrange fields within your pivot table.</li>
<li><strong>Show/Hide</strong>: Customize the display of various elements in your pivot table, such as subtotals, grand totals, and field headers.</li>
</ul>
</section>
<section id="filter" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="filter"><strong>Filter</strong></h4>
<ul>
<li><strong>Insert Slicer</strong>: When you have multiple fields in your PivotTable, inserting a slicer allows you to create visual buttons that can filter data based on the selected criteria.</li>
<li><strong>Insert Timeline</strong>: It allows you to filter data by specific dates using an interactive timeline control.</li>
</ul>
</section>
<section id="calculations" class="level4 unnumbered">
<h4 class="unnumbered anchored" data-anchor-id="calculations"><strong>Calculations</strong></h4>
<ul>
<li><strong>Fields, Items &amp; Sets</strong>: Create calculated fields, calculated items, or calculated sets to extend the functionality of your pivot table with custom calculations.</li>
</ul>
<p>The Pivot Table in itself can be written in one whole chapter. But here we are only giving you only the basics of the pivot table. You can learn more about pivot tables from other sources. Consider this section as an introduction to pivot tables and try mastering it since pivot table is one of the most amazing feature in Excel.</p>
<p>Happy Pivoting!!!</p>


</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./visualizations.html" class="pagination-link" aria-label="Creating Visuals">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Creating Visuals</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./power_query.html" class="pagination-link" aria-label="Power Query">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Power Query</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Excel Workshop 2024 Handbook was written by Razi N.</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This book was built with <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>